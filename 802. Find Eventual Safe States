class Solution {
    public List<Integer> eventualSafeNodes(int[][] graph) {
        int n = graph.length;
        int[] in = new int[n];
        Queue<Integer> q = new LinkedList<>();
        ArrayList<Integer>[] adj = new ArrayList[n];
        ArrayList<Integer> ans = new ArrayList<>();
        
        for (int i = 0; i < n; i++) {
         adj[i] = new ArrayList<>();
        }
        for(int i=0;i<n;i++){
            if(graph[i].length>0){
            for(int j=0;j<graph[i].length;j++){
                adj[graph[i][j]].add(i);
                in[i]++;
            }
            }
        }
        for(int i=0;i<n;i++){
            if(in[i]==0)q.add(i);
        }
        while(q.size()>0){
            int num = q.remove();
            ans.add(num);
            
            for(int i=0;i<adj[num].size();i++){
                if(--in[adj[num].get(i)]==0)q.add(adj[num].get(i));
            }

        }
    
Collections.sort(ans);

return ans;

    }
}
